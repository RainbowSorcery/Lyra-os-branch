     1 00000000                                 ; naskfun
     2 00000000                                 ; tab = 4
     3 00000000                                 [FORMAT "WCOFF"]
     4 00000000                                 [BITS 32]
     5 00000000                                 
     6 00000000                                 [INSTRSET "i486p"]	
     7 00000000                                 
     8 00000000                                 [FILE "naskfunc.nas"]
     9 00000000                                     GLOBAL _io_hlt
    10 00000000                                     GLOBAL _write_mem8
    11 00000000                                     GLOBAL _io_cli
    12 00000000                                     GLOBAL _io_out8
    13 00000000                                     GLOBAL _io_load_eflags
    14 00000000                                     GLOBAL _io_store_eflags
    15 00000000                                     GLOBAL _io_sti
    16 00000000                                     GLOBAL _load_gdtr
    17 00000000                                     GLOBAL _load_idtr
    18 00000000                                 
    19 00000000                                 
    20                                          [SECTION .text]
    21 00000000                                 _io_hlt: 
    22 00000000 F4                                  hlt
    23 00000001 C3                                  RET
    24 00000002                                 
    25 00000002                                 _write_mem8:
    26 00000002 8B 4C 24 04                         mov ecx, [esp + 4]
    27 00000006 8A 44 24 08                         mov al, [esp + 8]
    28 0000000A 88 01                               mov [ecx], al
    29 0000000C C3                                  RET
    30 0000000D                                 
    31 0000000D                                 _io_cli: 
    32 0000000D FA                                  cli
    33 0000000E C3                                  RET
    34 0000000F                                 
    35 0000000F                                 _io_out8:
    36 0000000F 8B 54 24 04                         mov edx, [esp + 4] ; port
    37 00000013 8A 44 24 08                         mov al, [esp + 8] ; data
    38 00000017 EE                                  out dx, al
    39 00000018 C3                                  RET
    40 00000019                                 
    41 00000019                                 _io_load_eflags:
    42 00000019 9C                                  pushfd
    43 0000001A 58                                  pop eax
    44 0000001B C3                                  RET
    45 0000001C                                 
    46 0000001C                                 _io_store_eflags:
    47 0000001C 8B 44 24 04                         mov eax, [esp + 4]
    48 00000020 50                                  push eax
    49 00000021 9D                                  popfd
    50 00000022 C3                                  RET
    51 00000023                                 
    52 00000023                                 _io_sti:
    53 00000023 FB                                  sti
    54 00000024 C3                                  RET
    55 00000025                                 
    56 00000025                                 _load_gdtr:		; void load_gdtr(int limit, int addr);
    57 00000025 66 8B 44 24 04                  		MOV		AX,[ESP+4]		; limit
    58 0000002A 66 89 44 24 06                  		MOV		[ESP+6],AX
    59 0000002F 0F 01 54 24 06                  		LGDT	[ESP+6]
    60 00000034 C3                              		RET
    61 00000035                                 
    62 00000035                                 _load_idtr:		; void load_idtr(int limit, int addr);
    63 00000035 66 8B 44 24 04                  		MOV		AX,[ESP+4]		; limit
    64 0000003A 66 89 44 24 06                  		MOV		[ESP+6],AX
    65 0000003F 0F 01 5C 24 06                  		LIDT	[ESP+6]
    66 00000044 C3                              		RET