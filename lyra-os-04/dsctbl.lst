     1 00000000                                 [FORMAT "WCOFF"]
     2 00000000                                 [INSTRSET "i486p"]
     3 00000000                                 [OPTIMIZE 1]
     4 00000000                                 [OPTION 1]
     5 00000000                                 [BITS 32]
     6 00000000                                 	EXTERN	_load_gdtr
     7 00000000                                 	EXTERN	_load_idtr
     8 00000000                                 [FILE "dsctbl.c"]
     9                                          [SECTION .text]
    10 00000000                                 	ALIGN	2
    11 00000000                                 	GLOBAL	_init_gdtidt
    12 00000000                                 _init_gdtidt:
    13 00000000 55                              	PUSH	EBP
    14 00000001 89 E5                           	MOV	EBP,ESP
    15 00000003 83 EC 18                        	SUB	ESP,24
    16 00000006 C7 45 FC 00270000               	MOV	DWORD [-4+EBP],2555904
    17 0000000D C7 45 F8 0026F800               	MOV	DWORD [-8+EBP],2553856
    18 00000014 C7 45 F4 00000000               	MOV	DWORD [-12+EBP],0
    19 0000001B C7 45 F4 00000000               	MOV	DWORD [-12+EBP],0
    20 00000022                                 L2:
    21 00000022 81 7D F4 00001FFF               	CMP	DWORD [-12+EBP],8191
    22 00000029 7E 02                           	JLE	L5
    23 0000002B EB 1F                           	JMP	L3
    24 0000002D                                 L5:
    25 0000002D 6A 00                           	PUSH	0
    26 0000002F 6A 00                           	PUSH	0
    27 00000031 6A 00                           	PUSH	0
    28 00000033 8B 45 F4                        	MOV	EAX,DWORD [-12+EBP]
    29 00000036 C1 E0 03                        	SAL	EAX,3
    30 00000039 03 45 FC                        	ADD	EAX,DWORD [-4+EBP]
    31 0000003C 50                              	PUSH	EAX
    32 0000003D E8 0000009A                     	CALL	_set_segmdesc
    33 00000042 83 C4 10                        	ADD	ESP,16
    34 00000045 8D 45 F4                        	LEA	EAX,DWORD [-12+EBP]
    35 00000048 FF 00                           	INC	DWORD [EAX]
    36 0000004A EB D6                           	JMP	L2
    37 0000004C                                 L3:
    38 0000004C 68 00001092                     	PUSH	4242
    39 00000051 6A 00                           	PUSH	0
    40 00000053 6A FF                           	PUSH	-1
    41 00000055 8B 45 FC                        	MOV	EAX,DWORD [-4+EBP]
    42 00000058 83 C0 08                        	ADD	EAX,8
    43 0000005B 50                              	PUSH	EAX
    44 0000005C E8 0000007B                     	CALL	_set_segmdesc
    45 00000061 83 C4 10                        	ADD	ESP,16
    46 00000064 68 0000409A                     	PUSH	16538
    47 00000069 6A 00                           	PUSH	0
    48 0000006B 68 FFF7FFFF                     	PUSH	-524289
    49 00000070 8B 45 FC                        	MOV	EAX,DWORD [-4+EBP]
    50 00000073 83 C0 10                        	ADD	EAX,16
    51 00000076 50                              	PUSH	EAX
    52 00000077 E8 00000060                     	CALL	_set_segmdesc
    53 0000007C 83 C4 10                        	ADD	ESP,16
    54 0000007F 83 EC 08                        	SUB	ESP,8
    55 00000082 68 00270000                     	PUSH	2555904
    56 00000087 68 0000FFFF                     	PUSH	65535
    57 0000008C E8 [00000000]                   	CALL	_load_gdtr
    58 00000091 83 C4 10                        	ADD	ESP,16
    59 00000094 C7 45 F4 00000000               	MOV	DWORD [-12+EBP],0
    60 0000009B                                 L6:
    61 0000009B 81 7D F4 000000FF               	CMP	DWORD [-12+EBP],255
    62 000000A2 7E 02                           	JLE	L9
    63 000000A4 EB 1F                           	JMP	L7
    64 000000A6                                 L9:
    65 000000A6 6A 00                           	PUSH	0
    66 000000A8 6A 00                           	PUSH	0
    67 000000AA 6A 00                           	PUSH	0
    68 000000AC 8B 45 F4                        	MOV	EAX,DWORD [-12+EBP]
    69 000000AF C1 E0 03                        	SAL	EAX,3
    70 000000B2 03 45 F8                        	ADD	EAX,DWORD [-8+EBP]
    71 000000B5 50                              	PUSH	EAX
    72 000000B6 E8 000000A1                     	CALL	_set_gatedesc
    73 000000BB 83 C4 10                        	ADD	ESP,16
    74 000000BE 8D 45 F4                        	LEA	EAX,DWORD [-12+EBP]
    75 000000C1 FF 00                           	INC	DWORD [EAX]
    76 000000C3 EB D6                           	JMP	L6
    77 000000C5                                 L7:
    78 000000C5 83 EC 08                        	SUB	ESP,8
    79 000000C8 68 0026F800                     	PUSH	2553856
    80 000000CD 68 000007FF                     	PUSH	2047
    81 000000D2 E8 [00000000]                   	CALL	_load_idtr
    82 000000D7 83 C4 10                        	ADD	ESP,16
    83 000000DA C9                              	LEAVE
    84 000000DB C3                              	RET
    85 000000DC                                 	ALIGN	2
    86 000000DC                                 	GLOBAL	_set_segmdesc
    87 000000DC                                 _set_segmdesc:
    88 000000DC 55                              	PUSH	EBP
    89 000000DD 89 E5                           	MOV	EBP,ESP
    90 000000DF 53                              	PUSH	EBX
    91 000000E0 81 7D 0C 000FFFFF               	CMP	DWORD [12+EBP],1048575
    92 000000E7 76 09                           	JBE	L11
    93 000000E9 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
    94 000000EC C1 E8 0C                        	SHR	EAX,12
    95 000000EF 89 45 0C                        	MOV	DWORD [12+EBP],EAX
    96 000000F2                                 L11:
    97 000000F2 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
    98 000000F5 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
    99 000000F8 66 89 02                        	MOV	WORD [EDX],AX
   100 000000FB 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
   101 000000FE B8 FFFFFFFF                     	MOV	EAX,-1
   102 00000103 23 45 10                        	AND	EAX,DWORD [16+EBP]
   103 00000106 66 89 42 02                     	MOV	WORD [2+EDX],AX
   104 0000010A 8B 4D 08                        	MOV	ECX,DWORD [8+EBP]
   105 0000010D 8B 45 10                        	MOV	EAX,DWORD [16+EBP]
   106 00000110 89 C2                           	MOV	EDX,EAX
   107 00000112 C1 FA 10                        	SAR	EDX,16
   108 00000115 B0 FF                           	MOV	AL,-1
   109 00000117 21 D0                           	AND	EAX,EDX
   110 00000119 88 41 04                        	MOV	BYTE [4+ECX],AL
   111 0000011C 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
   112 0000011F B0 FF                           	MOV	AL,-1
   113 00000121 23 45 14                        	AND	EAX,DWORD [20+EBP]
   114 00000124 88 42 05                        	MOV	BYTE [5+EDX],AL
   115 00000127 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
   116 0000012A 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
   117 0000012D C1 E8 10                        	SHR	EAX,16
   118 00000130 88 C1                           	MOV	CL,AL
   119 00000132 83 E1 0F                        	AND	ECX,15
   120 00000135 8B 45 14                        	MOV	EAX,DWORD [20+EBP]
   121 00000138 89 C2                           	MOV	EDX,EAX
   122 0000013A C1 FA 08                        	SAR	EDX,8
   123 0000013D B0 F0                           	MOV	AL,-16
   124 0000013F 21 D0                           	AND	EAX,EDX
   125 00000141 09 C8                           	OR	EAX,ECX
   126 00000143 88 43 06                        	MOV	BYTE [6+EBX],AL
   127 00000146 8B 4D 08                        	MOV	ECX,DWORD [8+EBP]
   128 00000149 8B 45 10                        	MOV	EAX,DWORD [16+EBP]
   129 0000014C 89 C2                           	MOV	EDX,EAX
   130 0000014E C1 FA 18                        	SAR	EDX,24
   131 00000151 B0 FF                           	MOV	AL,-1
   132 00000153 21 D0                           	AND	EAX,EDX
   133 00000155 88 41 07                        	MOV	BYTE [7+ECX],AL
   134 00000158 5B                              	POP	EBX
   135 00000159 5D                              	POP	EBP
   136 0000015A C3                              	RET
   137 0000015B 90                              	ALIGN	2
   138 0000015C                                 	GLOBAL	_set_gatedesc
   139 0000015C                                 _set_gatedesc:
   140 0000015C 55                              	PUSH	EBP
   141 0000015D 89 E5                           	MOV	EBP,ESP
   142 0000015F 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
   143 00000162 B8 FFFFFFFF                     	MOV	EAX,-1
   144 00000167 23 45 0C                        	AND	EAX,DWORD [12+EBP]
   145 0000016A 66 89 02                        	MOV	WORD [EDX],AX
   146 0000016D 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
   147 00000170 8B 45 10                        	MOV	EAX,DWORD [16+EBP]
   148 00000173 66 89 42 02                     	MOV	WORD [2+EDX],AX
   149 00000177 8B 4D 08                        	MOV	ECX,DWORD [8+EBP]
   150 0000017A 8B 45 14                        	MOV	EAX,DWORD [20+EBP]
   151 0000017D 89 C2                           	MOV	EDX,EAX
   152 0000017F C1 FA 08                        	SAR	EDX,8
   153 00000182 B0 FF                           	MOV	AL,-1
   154 00000184 21 D0                           	AND	EAX,EDX
   155 00000186 88 41 04                        	MOV	BYTE [4+ECX],AL
   156 00000189 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
   157 0000018C B0 FF                           	MOV	AL,-1
   158 0000018E 23 45 14                        	AND	EAX,DWORD [20+EBP]
   159 00000191 88 42 05                        	MOV	BYTE [5+EDX],AL
   160 00000194 8B 4D 08                        	MOV	ECX,DWORD [8+EBP]
   161 00000197 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
   162 0000019A 89 C2                           	MOV	EDX,EAX
   163 0000019C C1 FA 10                        	SAR	EDX,16
   164 0000019F B8 FFFFFFFF                     	MOV	EAX,-1
   165 000001A4 21 D0                           	AND	EAX,EDX
   166 000001A6 66 89 41 06                     	MOV	WORD [6+ECX],AX
   167 000001AA 5D                              	POP	EBP
   168 000001AB C3                              	RET
